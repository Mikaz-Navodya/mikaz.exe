<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mikaz.exe</title>
<link rel="icon" type="image/png" href="images/favicon.png">
<style>
/* ===== GLOBAL RESET & FONTS ===== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: "Courier New", monospace;
}

body {
  background: black;
  color: #00bfff;
  overflow-x: hidden; /* Prevent horizontal scroll */
}

/* LOCK SCROLL DURING SPLASH */
body.no-scroll {
  overflow: hidden;
  height: 100vh;
}

/* ===== SPLASH SCREEN STYLES ===== */
#splash-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  background-color: #000;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: #00bfff;
  padding: 20px;
}

#splash-content-area {
  width: 100%;
  max-width: 800px;
  min-height: 200px; /* Keep layout stable */
  display: flex;
  flex-direction: column;
  justify-content: center; /* Center vertically in the area */
}

#splash-text {
  font-size: 1.1rem;
  font-weight: bold;
  text-shadow: 0 0 10px #00bfff;
  white-space: pre-wrap;
  line-height: 1.6;
}

/* The waiting cursor specifically for splash */
.splash-cursor {
  display: inline-block;
  width: 10px;
  height: 1.2rem;
  background-color: #00bfff;
  margin-left: 5px;
  vertical-align: middle;
  animation: blink-block 0.8s infinite;
}

@keyframes blink-block {
  0%, 49% { opacity: 1; }
  50%, 100% { opacity: 0; }
}

#press-key-msg {
  margin-top: 40px;
  font-size: 1.4rem;
  color: #fff;
  animation: blink-text 1s infinite;
  display: none; /* Hidden initially */
  cursor: pointer;
  text-align: center;
  text-shadow: 0 0 10px #00bfff, 0 0 20px #00bfff;
  border: 1px solid #00bfff;
  padding: 10px 20px;
  background: rgba(0, 191, 255, 0.1);
}

@keyframes blink-text {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0; }
}

.fade-out {
  opacity: 0;
  transition: opacity 1s ease-out;
  pointer-events: none;
}

/* ===== MUSIC CONTROL ===== */
.music-btn {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 2000;
  background: rgba(0, 0, 0, 0.85);
  border: 1px solid #00bfff;
  color: #00bfff;
  padding: 10px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 0 10px rgba(0, 191, 255, 0.2);
  display: none; /* Hidden until splash ends */
  user-select: none;
}
.music-btn:hover { background: #00bfff; color: black; box-shadow: 0 0 20px #00bfff; }
.music-btn.muted { border-color: #555; color: #777; box-shadow: none; }

/* ===== CV BUTTON ===== */
.cv-fab-container {
  position: fixed;
  bottom: 30px;
  right: 30px;
  width: 70px;
  height: 70px;
  cursor: pointer;
  z-index: 2000; 
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.2s ease;
}
.cv-fab-container:hover { transform: scale(1.1); }
.cv-btn {
  width: 56px;
  height: 56px;
  background: rgba(0, 0, 0, 0.9);
  border-radius: 50%;
  border: 1px solid #00bfff;
  color: #00bfff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 1.1rem;
  box-shadow: 0 0 10px rgba(0, 191, 255, 0.4);
  position: absolute;
  z-index: 2002;
}
.progress-ring {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  transform: rotate(-90deg);
  pointer-events: none;
}
.progress-ring__circle {
  stroke: #00bfff;
  stroke-width: 4;
  stroke-dasharray: 283;
  stroke-dashoffset: 283;
  transition: stroke-dashoffset 1.5s ease-in-out;
  transform-origin: 50% 50%;
}

/* ===== GENERAL SECTIONS ===== */
h2 {
  border-left: 4px solid #00bfff;
  padding-left: 10px;
  margin-bottom: 20px;
  text-shadow: 0 0 10px #00bfff;
}
section { padding: 70px 10%; }

/* ===== BACKGROUND ===== */
canvas {
  position: fixed;
  top: 0;
  left: 0;
  z-index: -1;
  filter: blur(1.5px);
  opacity: 0.85;
}

/* ===== HEADER ===== */
header {
  padding: 40px;
  text-align: center;
  border-bottom: 1px solid #00bfff;
}
a { color: inherit; text-decoration: underline; }
header h1 {
  font-size: 3.2rem;
  font-weight: bold;
  text-shadow: 0 0 15px #00bfff, 0 0 35px #007bff;
}
.cursor::after {
  content: "_";
  margin-left: 5px;
  animation: blink 1s infinite;
}
@keyframes blink {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0; }
}

/* ===== PROFILE ===== */
.profile { text-align: center; padding: 60px 10%; }
.photo-wrapper {
  width: 240px;
  height: 260px;
  margin: auto;
  padding: 4px;
  background: linear-gradient(120deg, #00bfff, #0044ff, #00bfff);
  background-size: 300% 300%;
  animation: cyberFlow 3s linear infinite;
  box-shadow: 0 0 25px #00bfff;
}
@keyframes cyberFlow {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
.photo-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  background: black;
}

/* ===== TERMINAL ===== */
.command-box {
  margin-top: 40px;
  border: 1px solid #00bfff;
  padding: 18px;
  width: 400px;
  margin-left: auto;
  margin-right: auto;
  box-shadow: 0 0 20px #00bfff;
  text-align: left;
  font-weight: 700;
}
.output {
  font-size: 0.95rem;
  color: #66ccff;
  line-height: 1.6;
  min-height: 150px;
}
.command-options { margin-top: 20px; margin-bottom: 20px; display: none; }
.command-box input {
  width: 100%;
  background: black;
  border: none;
  outline: none;
  color: #00bfff;
  font-size: 1rem;
  font-weight: 700;
  display: none;
}

/* ===== SKILLS ===== */
.skill-item {
  cursor: pointer;
  margin: 10px 0;
  color: #00bfff;
  font-weight: bold;
  text-shadow: 0 0 8px #00bfff;
  font-size: 1.3rem;
}
.skill-item:hover {
  color: #66ccff;
  border: 1px solid rgba(0, 191, 255, 0.3);
  background: rgba(0, 191, 255, 0.1);
}
.skill-details {
  display: none;
  margin-top: 10px;
  margin-bottom: 20px;
  font-size: 0.9rem;
  color: #66ccff;
  border: 1px solid #00bfff;
  padding: 15px;
  background: rgba(0, 0, 0, 0.9);
  box-shadow: 0 0 15px rgba(0, 191, 255, 0.4);
  width: 100%;
  max-width: 500px;
}
.progress-line { margin: 6px 0; white-space: pre; }

/* ===== PROJECTS ===== */
.projects-container {
  display: flex;
  gap: 25px;
  overflow-x: auto;
  padding: 75px 55px 30px;
  scroll-behavior: smooth;
  height :480px;
  scrollbar-width: none;        
  -ms-overflow-style: none; 
}
.projects-container::-webkit-scrollbar { display:none; height: 26px; }

.project-card {
  min-width: 260px;
  position: relative;
  background-color: black;
  border: 1px solid #00bfff;
  padding: 20px;
  box-shadow: 0 0 15px rgba(0,191,255,0.6);
  transition: all 0.3s ease;
  cursor: pointer;
  height: 340px;
  background-size: cover;
  background-position: center;
  overflow: hidden;
}
.project-card::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(to bottom, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.4) 100%);
  z-index: 1;
  transition: background 0.3s ease;
}
.project-card h3 {
  position: relative;
  z-index: 2;
  color: #00bfff;
  margin-bottom: 10px;
  text-shadow: 0 0 10px #00bfff;
}
.project-card p {
  position: relative;
  z-index: 2;
  font-size: 0.9rem;
  color: #b3e6ff;
  line-height: 1.4;
  font-weight: 600;
  text-shadow: 1px 1px 2px black;
}
.project-card:hover {
  transform: translateY(-8px) scale(1.03);
  box-shadow: 0 0 30px #00bfff, 0 0 60px #007bff;
}
.project-card:hover::before { background: linear-gradient(to bottom, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.2) 100%); }

/* PLACEHOLDER IMAGES */
.img-game { background-image: url('images/project_card_images/game.png'); }
.img-web { background-image: url('images/project_card_images/web.png'); }
.img-erp { background-image: url('images/project_card_images/erp.png'); }
.img-ai { background-image: url('images/project_card_images/ai.jpeg'); }
.img-nlp { background-image: url('images/project_card_images/nlp.png'); }
.img-ml { background-image: url('images/project_card_images/ml.png'); }

/* ===== ABOUT TERMINAL ===== */
.terminal-view {
  border: 1px solid #00bfff;
  background: rgba(0, 0, 0, 0.9);
  padding: 30px;
  box-shadow: 0 0 20px rgba(0, 191, 255, 0.15);
  font-family: "Courier New", monospace;
  color: #66ccff;
  line-height: 1.6;
  max-width: 1000px;
  margin: 0 auto;
  position: relative;
}
.terminal-header-bar {
  border-bottom: 1px solid #00bfff;
  padding-bottom: 10px;
  margin-bottom: 15px;
  color: #00bfff;
  font-weight: bold;
  font-size: 0.9rem;
  display: flex;
  justify-content: space-between;
}
.term-line { display: block; margin-bottom: 8px; }
.term-prompt { color: #00bfff; font-weight: bold; margin-right: 10px; }

/* ===== EXPERIENCE ===== */
.mech-container { display: flex; flex-direction: column; gap: 60px; padding-top: 30px; }
.mech-wrapper { position: relative; width: 100%; max-width: 700px; margin: 0 auto; }
.mech-card {
  position: relative;
  background: rgba(0, 0, 0, 0.85);
  border: 2px solid #00bfff; 
  padding: 40px 30px 30px 40px;
  clip-path: polygon(20px 0, 100% 0, 100% calc(100% - 20px), calc(100% - 20px) 100%, 0 100%, 0 20px);
  box-shadow: 0 0 15px rgba(0, 191, 255, 0.2);
  transition: transform 0.3s ease;
}
.mech-wrapper:hover .mech-card { transform: scale(1.01); box-shadow: 0 0 25px rgba(0, 191, 255, 0.4); }
.mech-notch-top {
  position: absolute; top: -2px; left: 50%; transform: translateX(-50%);
  width: 120px; height: 12px; background: black;
  border-bottom: 2px solid #00bfff; border-left: 2px solid #00bfff; border-right: 2px solid #00bfff;
  clip-path: polygon(0 0, 15px 100%, 105px 100%, 120px 0); z-index: 10;
}
.mech-tab-bottom {
  position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%);
  width: 140px; height: 12px; background: #00bfff;
  clip-path: polygon(15px 0, 125px 0, 140px 100%, 0 100%); z-index: 10;
}
.mech-badge-outer {
  position: absolute; top: -27px; left: -17px; width: 54px; height: 60px;
  background: #00bfff;
  clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
  z-index: 15; box-shadow: 0 0 15px #00bfff;
  display: flex; align-items: center; justify-content: center;
}
.mech-badge-inner {
  width: 50px; height: 56px; background: black; color: #00bfff;
  clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
  display: flex; align-items: center; justify-content: center;
  font-weight: bold; font-size: 1.4rem;
}
.mech-content h3 { color: #ffffff; font-size: 1.2rem; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
.mech-content .role { color: #00bfff; font-weight: bold; margin-bottom: 15px; display: block; }
.mech-content p { color: #aaddff; font-size: 0.9rem; line-height: 1.6; }

/* ===== EDUCATION ===== */
.edu-container { display: flex; flex-direction: column; gap: 30px; }
.edu-card {
  position: relative;
  border: 1px solid #00bfff;
  background: rgba(0, 0, 0, 0.85);
  padding: 30px 20px 20px 30px;
  box-shadow: 0 0 10px rgba(0, 191, 255, 0.2);
  transition: all 0.3s ease;
}
.edu-card:hover { box-shadow: 0 0 20px rgba(0, 191, 255, 0.5); transform: translateX(5px); }
.gears-box { position: absolute; top: -15px; left: -15px; width: 50px; height: 50px; z-index: 10; }
.gear { position: absolute; color: #00bfff; line-height: 1; text-shadow: 0 0 5px #00bfff; }
.gear-lg { font-size: 28px; top: 0; left: 0; animation: spin-right 4s linear infinite; }
.gear-sm { font-size: 18px; top: 22px; left: 22px; color: #ffffff; animation: spin-left 2s linear infinite; }
@keyframes spin-right { 100% { transform: rotate(360deg); } }
@keyframes spin-left { 100% { transform: rotate(-360deg); } }
.edu-title { color: #fff; font-size: 1.1rem; font-weight: bold; margin-left: 20px; margin-bottom: 5px; }
.edu-desc { color: #66ccff; font-size: 0.9rem; margin-left: 20px; margin-bottom: 20px; }
.edu-bar { font-family: 'Courier New', monospace; font-size: 0.85rem; color: #00bfff; white-space: pre; overflow-x: hidden; opacity: 0.9; }

/* ===== MEDIA QUERIES ===== */
@media (max-width: 1024px) {
  section { padding: 60px 6%; }
  header h1 { font-size: 2.6rem; }
  .projects-container { padding: 60px 30px 30px; }
}
@media (max-width: 768px) {
  header { padding: 25px 10px; }
  header h1 { font-size: 2.2rem; }
  .profile { padding: 40px 6%; }
  .photo-wrapper { width: 190px; height: 210px; }
  .command-box { width: 100%; max-width: 100%; font-size: 0.9rem; }
  .output { min-height: 120px; }
  section { padding: 50px 6%; }
  h2 { font-size: 1.2rem; }
  .projects-container { gap: 20px; height: auto; padding: 40px 15px; }
  .project-card { min-width: 240px; height: auto; min-height: 300px; }
  .mech-card { padding: 30px 20px 25px 25px; }
  .edu-card { padding: 25px 15px 20px 25px; }
  .edu-title, .edu-desc { margin-left: 10px; }
}
@media (max-width: 480px) {
  header h1 { font-size: 1.9rem; }
  .music-btn { top: 10px; left: 10px; padding: 8px 12px; font-size: 1.2rem; }
  .cv-fab-container { width: 56px; height: 56px; }
  .cv-btn { width: 44px; height: 44px; font-size: 0.85rem; }
  .photo-wrapper { width: 160px; height: 180px; }
  .command-box { padding: 14px; }
  .output { font-size: 0.85rem; }
  .projects-container { padding: 30px 10px; }
  .project-card { min-width: 220px; }
  .mech-badge-outer { transform: scale(0.85); }
  .edu-bar { font-size: 0.75rem; }
  .progress-line { font-size: 0.8rem; }
  canvas { filter: blur(1px); }
}
</style>
</head>

<body class="no-scroll">

<audio id="bg-music" loop>
  <source src="background-music.mp3" type="audio/mp3">
</audio>

<div id="music-control" class="music-btn" onclick="toggleMusic()">
  ðŸ”Š
</div>

<div id="splash-screen">
  <div id="splash-content-area">
    <div id="splash-text"></div>
  </div>
  <div id="press-key-msg">[ PRESS ANY KEY TO ENTER SYSTEM ]</div>
</div>

<div class="cv-fab-container" onclick="downloadCV()">
  <svg class="progress-ring" viewBox="0 0 100 100">
    <circle class="progress-ring__circle" cx="50" cy="50" r="45" fill="transparent" />
  </svg>
  <div class="cv-btn">CV</div>
</div>

<canvas id="matrix"></canvas>

<header>
  <h1 class="cursor">> Mikaz.exe</h1>
</header>

<div class="profile">
  <div class="photo-wrapper">
    <img src="your-photo.jpg" alt="Profile Photo">
  </div>

  <div class="command-box">
    <div class="output" id="output"></div>
    <div class="command-options" id="commandMenu"></div>
    > Enter command:
    <input type="text" id="commandInput" placeholder="type and press Enter">
  </div>
</div>

<section id="about">
  <h2>> About</h2>
  <div class="terminal-view">
    <div class="terminal-header-bar">
      <span>root@mikaz-system:~/bio</span>
      <span>[rw-r--r--]</span>
    </div>
    <span class="term-line"><span class="term-prompt">> Curiosity led me to machine learning. Patterns kept me there.
    <br><br>> I enjoy exploring data, understanding how models learn, and turning raw information into meaningful predictions. For me, machine learning isnâ€™t magic â€” itâ€™s logic, experimentation, and constant refinement.
    <br><br>> Iâ€™m continuously learning, building, and questioning how intelligent systems behave in the real world â€” one model at a time.</span>
  </div>
</section>

<section id="skills">
  <h2>> Skills</h2>
  <div class="skill-item" onclick="toggleSkill(this, 'soft')">â–¸ Soft Skills</div>
  <div class="skill-details" id="soft"></div>
  
  <div class="skill-item" onclick="toggleSkill(this, 'ai')">â–¸ AI</div>
  <div class="skill-details" id="ai"></div>
  
  <div class="skill-item" onclick="toggleSkill(this, 'ml')">â–¸ ML</div>
  <div class="skill-details" id="ml"></div>
  
  <div class="skill-item" onclick="toggleSkill(this,'web')">â–¸ Web Development</div>
  <div class="skill-details" id="web"></div>

  <div class="skill-item" onclick="toggleSkill(this,'game')">â–¸ Game Development</div>
  <div class="skill-details" id="game"></div>
</section>

<section id="projects">
  <h2>> Projects</h2>
  <div class="projects-container">
    <div class="project-card img-ml" onclick="window.open('ml_projects.html', '_blank')">
      <h3>> Machine Learning</h3>
      <p>Algorithms from scratch, Student performance predictor, Mushroom categorizer</p>
    </div>
    <div class="project-card img-nlp" onclick="window.open('nlp_projects.html', '_blank')">
      <h3>> NLP Projects</h3>
      <p>sentiment analysis</p>
    </div>
    <div class="project-card img-game" onclick="window.open('gd_projects.html', '_blank')">
      <h3>> Game Development</h3>
      <p>Unreal Engine, gameplay mechanics, level design</p>
    </div>
    <div class="project-card img-web">
      <h3>> Web Development</h3>
      <p>Under Construction</p>
    </div>
    <div class="project-card img-erp">
      <h3>> ERP Systems</h3>
      <p>Under Construction</p>
    </div>
    <div class="project-card img-ai">
      <h3>> AI Projects</h3>
      <p>Under Construction</p>
    </div>
  </div>
</section>

<section id="experience">
  <h2>> Experience</h2>
  <div class="mech-container">
    <div class="mech-wrapper">
      <div class="mech-badge-outer"><div class="mech-badge-inner">1</div></div>
      <div class="mech-notch-top"></div>
      <div class="mech-card">
        <div class="mech-content">
          <h3>Game Development Instructor</h3>
          <span class="role">> Mogo Media Academy [2025]</span>
          <li>Taught Unreal Engine Blueprint visual scripting to students with different knowledge levels. </li><br>
          <li>Guided students through hands-on projects to build game mechanics and interactive systems. </li><br>
          <li>Instructed on Animation Blueprints for character movement and animation blending. </li><br>
          <li>Provided comprehensive explanations and real-world examples to help students understand and apply game development techniques effectively. </li><br>
          <li>Guided students through hands-on, project-based learning, helping them build fully functional games and interactive prototypes</li>
        </div>
      </div>
      <div class="mech-tab-bottom"></div>
    </div>
    <div class="mech-wrapper">
      <div class="mech-badge-outer"><div class="mech-badge-inner">2</div></div>
      <div class="mech-notch-top"></div>
      <div class="mech-card">
        <div class="mech-content">
          <h3>Indie Game Developer</h3>
          <span class="role">> Self-Directed Projects | Unreal Engine | [2021 â€“ 2024]</span>
          <li> Designed and developed two original game prototypes using Unreal Engine.</li><br>
          <li>Implemented core systems including player movement, combat interactions, and environmental effects to create immersive gameplay experiences.</li><br>
          <li>Experimented with blueprint scripting and C++ integration, rapid prototyping with performance optimization.</li><br>
          <li>Built custom assets and integrated third-party resources to enhance gameplay functionality.</li><br>
          <li>Conducted playtesting and feedback sessions to refine mechanics, improve UX, and improve overall design.</li><br>
          <li>Gained hands-on experience in project scoping, Game design document, and solo development workflows.</li>
        </div>
      </div>
      <div class="mech-tab-bottom"></div>
    </div>
  </div>
</section>

<section id="education">
  <h2>> Education</h2>
  <div class="edu-container">
    <div class="edu-card">
      <div class="gears-box">
        <div class="gear gear-lg">âš™</div>
        <div class="gear gear-sm">âš™</div>
      </div>
      <div class="edu-title">> Bachelor of Computing in Information Systems</div>
      <div class="edu-desc">University of Sri Jayewardenepura<br>GPA : 3.62</div>
      <div class="edu-bar">| =============================         | _78%</div>
    </div>
    <div class="edu-card">
      <div class="gears-box">
        <div class="gear gear-lg">âš™</div>
        <div class="gear gear-sm">âš™</div>
      </div>
      <div class="edu-title">> G.C.E Advance level - Maths Stream</div>
      <div class="edu-desc">Kuliyapitiya Central College</div>
      <div class="edu-bar">| ===================================== | 100%</div>
    </div>
    <div class="edu-card">
      <div class="gears-box">
        <div class="gear gear-lg">âš™</div>
        <div class="gear gear-sm">âš™</div>
      </div>
      <div class="edu-title">> Grade 5 - Scholarship Exam</div>
      <div class="edu-desc">Narammala Mayurapadha Junior School</div>
      <div class="edu-bar">| ===================================== | 100%</div>
    </div>
  </div>
</section>

<section id="contact">
  <h2>> Contact</h2>
  <li>âœ” Email      : mikaznavodya@gmail.com</li>
  <li>âœ” GitHub     : <a href="https://github.com/Mikaz-Navodya" target="_blank">https://github.com/Mikaz-Navodya</a></li>
  <li>âœ” LinkedIn   : <a href="https://www.linkedin.com/in/mikaz-navodya-b4b395262/" target="_blank">https://www.linkedin.com/in/mikaz-navodya-b4b395262/</a></li>
  <li>âœ” Location   : Sri Lanka (Remote Ready)</li>
  <li>âœ” Status     : Available for Opportunities</li>
</section>

<script>
/* ===== 1. ASSET LOADING TRACKER ===== */
// We create a promise that resolves when all heavy assets (images, etc) are loaded
let assetsReady = false; // <--- ADD THIS FLAG
let assetsLoadedPromise = new Promise((resolve) => {
  window.addEventListener('load', () => {
    assetsReady = true; // <--- UPDATE FLAG HERE
    resolve();
  });
});

/* ===== 2. SPLASH SCREEN LOGIC (ASYNC/AWAIT) ===== */
const splashText = document.getElementById("splash-text");
const pressKeyMsg = document.getElementById("press-key-msg");
const splashScreen = document.getElementById("splash-screen");
const musicBtn = document.getElementById("music-control");
const audio = document.getElementById("bg-music");

// Utility: Wait function for async pauses
const wait = (ms) => new Promise(resolve => setTimeout(resolve, ms));

// Utility: Type specific text line
async function typeLine(text) {
  const lineDiv = document.createElement('div');
  lineDiv.style.marginBottom = "5px"; 
  splashText.appendChild(lineDiv);
  
  for (let i = 0; i < text.length; i++) {
    lineDiv.textContent += text.charAt(i);
    await wait(30); // Typing speed
  }
  await wait(200); // Slight pause after line finish
}

// Main Boot Sequence
// Main Boot Sequence
async function runBootSequence() {
  await wait(500); 
  await typeLine("> Initializing System...");
  await typeLine("> Loading Kernels...");
  await typeLine("> Verifying Encryption Keys...");
  
  // The Loading Phase
  const loadingLine = document.createElement('div');
  loadingLine.style.marginBottom = "5px";
  
  // Create spans for text, percentage, and cursor
  const textSpan = document.createElement('span');
  textSpan.textContent = "> Downloading Assets... ";
  
  const percentSpan = document.createElement('span');
  percentSpan.textContent = "0%";
  
  const cursorSpan = document.createElement('span');
  cursorSpan.className = "splash-cursor";
  
  loadingLine.appendChild(textSpan);
  loadingLine.appendChild(percentSpan);
  loadingLine.appendChild(cursorSpan);
  
  splashText.appendChild(loadingLine);
  
  /* --- PERCENTAGE LOGIC START --- */
  let percent = 0;
  
  // Loop until assets are ready OR we hit 99%
  while (percent < 99) {
    if (assetsReady) break; // If loaded, break loop to jump to 100
    
    percent++;
    percentSpan.textContent = `${percent}%`;
    
    // Randomize speed to look like real processing (20ms to 80ms delay)
    await wait(Math.random() * 75 + 5); 
  }
  
  // If we hit 99% but assets still aren't ready, wait here
  while (!assetsReady) {
    await wait(100);
  }
  
  // Force 100% when done
  percentSpan.textContent = "100%";
  percentSpan.style.color = "#00bfff"; // Optional: Highlight 100%
  /* --- PERCENTAGE LOGIC END --- */
  
  await wait(500); // Pause briefly at 100%
  loadingLine.innerHTML = "> Downloading Assets... [DONE]"; 
  
  await typeLine("> Establishing Secure Connection...");
  await wait(300);
  
  const grantDiv = document.createElement('div');
  grantDiv.style.color = "#00ff00";
  grantDiv.style.marginTop = "15px";
  grantDiv.textContent = "> ACCESS GRANTED.";
  splashText.appendChild(grantDiv);
  
  await wait(500);
  pressKeyMsg.style.display = "block";
  
  // Add listeners to close splash
  document.addEventListener("keydown", endSplash);
  document.addEventListener("click", endSplash);
}

// Start sequence as soon as HTML structure is ready (don't wait for images yet)
document.addEventListener("DOMContentLoaded", () => {
  runBootSequence();
});

function endSplash() {
  document.removeEventListener("keydown", endSplash);
  document.removeEventListener("click", endSplash);
  
  // Enable scrolling
  document.body.classList.remove("no-scroll");

  // Attempt Audio
  audio.volume = 0.4;
  audio.play().catch(e => console.log("Audio play failed:", e));
  updateMusicBtnText();
  musicBtn.style.display = "block";

  // Fade out
  splashScreen.classList.add("fade-out");
  
  setTimeout(() => {
    splashScreen.style.display = "none";
    bootMainTerminal(); // Start the main site terminal
  }, 1000);
}


/* ===== 3. MUSIC CONTROL LOGIC ===== */
function updateMusicBtnText() {
  if (audio.paused) {
    musicBtn.innerHTML = "ðŸ”‡" ;
    musicBtn.classList.add("muted");
  } else {
    musicBtn.innerHTML = "ðŸ”Š";
    musicBtn.classList.remove("muted");
  }
}

function toggleMusic() {
  if (audio.paused) {
    audio.play();
  } else {
    audio.pause();
  }
  updateMusicBtnText();
}
window.addEventListener("resize", updateMusicBtnText);


/* ===== 4. DOWNLOAD CV LOGIC ===== */
function downloadCV() {
  const circle = document.querySelector('.progress-ring__circle');
  const btn = document.querySelector('.cv-btn');
  
  circle.style.strokeDashoffset = '0';
  btn.style.boxShadow = '0 0 25px #00bfff';
  btn.textContent = "WAIT";

  setTimeout(() => {
    btn.textContent = "DONE";
    window.open('CV_Mikaz_Navodya.pdf', '_blank'); 
    setTimeout(() => {
      circle.style.strokeDashoffset = '283'; 
      btn.textContent = "CV";
      btn.style.boxShadow = '0 0 10px rgba(0, 191, 255, 0.4)';
    }, 2000);
  }, 1500);
}


/* ===== 5. SKILLS TERMINAL UTILS ===== */
const skillData = {
  web: [
    { name: "HTML", level: 80 }, { name: "CSS", level: 70 },
    { name: "JS", level: 60 }, { name: "React", level: 0 },
    { name: "NextJS", level: 0 }, { name: "ExpressJS", level: 0 },
    { name: "NodeJS", level: 0 }
  ],
  game: [ { name: "Unreal Engine", level: 80 }, { name: "Unity Engine", level: 2 } ],
  ai: [
    { name: "Python", level: 85 }, { name: "ML", level: 80 },
    { name: "SQL", level: 85 }, { name: "Calculus", level: 60 },
    { name: "Linear Algebra", level: 60 }, { name: "Probability", level: 65 },
    { name: "Statistics", level: 65 }, { name: "Numpy", level: 70 },
    { name: "Pandas", level: 50 }, { name: "Matplotlib", level: 40 },
    { name: "NLP", level: 40 }, { name: "Deep Learning", level: 20 },
    { name: "MLOps", level: 10 }
  ],
  soft: [
    { name: "Problem Solving", level: 80 }, { name: "Communication", level: 50 },
    { name: "Team work", level: 90 }, { name: "Story telling", level: 70 }
  ],
  ml: [
    { name: "Supervised", level: 85 }, { name: "Unsupervised", level: 80 },
    { name: "Recom. System", level: 70 }, { name: "Reinforcement L.", level: 80 },
    { name: "SciKit", level: 75 }, { name: "Feature Eng.", level: 85 },
    { name: "Model Evaluation", level: 85 }, { name: "Overfitting", level: 80 }
  ]
};

function makeBar(percent, totalChars) {
  const filled = Math.round((percent / 100) * totalChars);
  return "#".repeat(filled) + "-".repeat(totalChars - filled);
}

function toggleSkill(element, id) {
  const box = document.getElementById(id);
  const isMobile = window.innerWidth <= 480;
  const barLength = isMobile ? 12 : 25;
  const padLength = isMobile ? 10 : 14;

  if (box.style.display === "block") {
    box.style.display = "none";
    box.innerHTML = "";
    element.innerHTML = element.innerHTML.replace("â–¾", "â–¸");
    return;
  }
  box.style.display = "block";
  box.innerHTML = "";
  element.innerHTML = element.innerHTML.replace("â–¸", "â–¾");

  skillData[id].forEach((skill) => {
    const line = document.createElement("div");
    line.className = "progress-line";
    let displayName = skill.name;
    if (isMobile && displayName.length > padLength) {
       displayName = displayName.substring(0, padLength - 1) + ".";
    }
    const label = `--- ${displayName.padEnd(padLength)} : `;
    line.textContent = label;
    box.appendChild(line);

    let current = 0;
    const interval = setInterval(() => {
      if (current <= skill.level) {
        line.textContent = label + makeBar(current, barLength) + ` = ${String(current).padStart(2, "0")}%`;
        current++;
      } else {
        clearInterval(interval);
      }
    }, 15);
  });
}

/* ===== 6. MATRIX RAIN ===== */
const canvas = document.getElementById("matrix");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;
const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
const fontSize = 18;
const columns = canvas.width / fontSize;
const drops = Array.from({ length: columns }, () => Math.random() * canvas.height);

setInterval(() => {
  ctx.fillStyle = "rgba(0,0,0,0.08)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "#00bfff";
  ctx.font = fontSize + "px monospace";
  drops.forEach((y, i) => {
    ctx.fillText(letters[Math.floor(Math.random()*letters.length)], i*fontSize, y*fontSize);
    drops[i] = y*fontSize > canvas.height && Math.random()>0.97 ? 0 : y+1;
  });
}, 33);

window.addEventListener("resize", () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});

/* ===== 7. MAIN SITE TERMINAL UTILS ===== */
function typeText(text, speed = 40, callback) {
  const output = document.getElementById("output");
  let i = 0;
  const interval = setInterval(() => {
    output.innerHTML += text.charAt(i);
    i++;
    if (i >= text.length) {
      clearInterval(interval);
      output.innerHTML += "<br>";
      if (callback) callback();
    }
  }, speed);
}

const bootLines = [
  "> Access Granted...",
  "",
  "> Welcome to Mikaz Navodya's portfolio",
  "> All systems online.",
  "> Explore freely.",
  "",
  "> Available Commands:",
  "- about",
  "- skills",
  "- projects",
  "- experience",
  "- education",
  "- contact",
  ""
];

let bootIndex = 0;
function bootMainTerminal() {
  const menu = document.getElementById("commandMenu");
  const input = document.getElementById("commandInput");
  
  if (bootIndex < bootLines.length) {
    typeText(bootLines[bootIndex], 25, () => {
      bootIndex++;
      setTimeout(bootMainTerminal, 150);
    });
  } else {
    menu.style.display = "block";
    input.style.display = "block";
    input.focus();
  }
}

/* ===== 8. COMMAND INPUT LOGIC ===== */
const logs = ["", "[+] Processing...", "[+] Fetching data...", "[+] Rendering view...", "[+] Done âœ”"];
const commandInput = document.getElementById("commandInput");
const outputDiv = document.getElementById("output");

commandInput.addEventListener("keydown", e => {
  if (e.key === "Enter") {
    const cmd = commandInput.value.toLowerCase().trim();
    commandInput.value = "";

    typeText("> " + cmd, 20, () => {
      let i = 0;
      function typeLog() {
        if (i < logs.length) {
          typeText(logs[i], 15, () => {
            i++;
            typeLog();
          });
        } else {
          const section = document.getElementById(cmd);
          if (section) {
            setTimeout(() => {
              outputDiv.innerHTML = "> Welcome back.<br>> Available Commands: <br>- about, skills, projects, experience, education, contact<br><br>";
              section.scrollIntoView({ behavior: "smooth" });
            }, 600);
          } else {
            typeText("âœ– Unknown command.", 20);
          }
        }
      }
      typeLog();
    });
  }
});
</script>

</body>
</html>